{% extends "network/layout.html" %}
{% load static %}

{% block body %}
{% if user.is_authenticated and not following %}

    <div id="new-post">
        <form method="POST" action="{% url 'new_post' %}" enctype="multipart/form-data">
            {% csrf_token %}
            <h5>NewPost</h5>
            <textarea required id="story" name="entry" rows="5" cols="100"></textarea>
            <br>
            Image: <input type="file" accept="image/*" class="image" name="image">
            <br>
            <input id="post_button" type="submit" value="Post">
        </form>
    </div>
{% endif %}

    <div id="all-post">
        {% if following %}
        <h5>Following Posts</h5>
        {% else %}
        <h5>All Posts</h5>
        {% endif %}

        <ul>
        {% for p in page_obj %}
        <li>
        {% if p.image %}    
        <img src="{{ p.image.url }}" width="500">
        {% endif %}
        <p>{{p.entry}}<br> by <a href="{% url 'profile' p.creator.id %}">{{p.creator}}</a> @ {{p.created_date}}</p>
        </li>
        
        {% if p.creator == user %}
        <div style="display:flex; margin-top:-15px; margin-bottom: 20px;">
            <form id="edit" action="{% url 'edit' p.id %}" method="post">
                {% csrf_token %}
                <div id="editInput">
                    <button id="editInputButton" >Edit</button>
                </div>
                <div id="editDiv" ></div>
            </form>
            <form method="post" action="{% url 'delete' p.id %}">
                {% csrf_token %}
                <input type="submit" value="Delete">
            </form>
        </div>
        
        {% endif %}

        {% endfor %}
        </ul>
        <div class="pagination">
            <span class="step-links">
                {% if page_obj.has_previous %}
                    <a href="?page=1">&laquo; first</a>
                    <a href="?page={{ page_obj.previous_page_number }}">previous</a>
                {% endif %}
        
                <span class="current">
                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                </span>
        
                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}">next</a>
                    <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
                {% endif %}
            </span>
        </div>

    </div>

{% endblock %}

{% block script %}

<script src="{% static 'network/network.js' %}"></script>
{% endblock %}

